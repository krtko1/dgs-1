\documentclass[12pt, twoside]{article}

\input{core/core.tex}
\input{core/format.tex}
\input{modules/(* module.id *)/styles/(* competition.id *)/format.tex}
\input{input/(* module.id *)/(* competition.id *)/(* volume.id *)/(* semester.id *)/1/format.tex}

\newcounter{volume}
\newcounter{semester}
\newcounter{round}
\newcounter{problem}
 
\begin{document}
    \pagestyle{main}
    \thispagestyle{first}
    \vspace*{4em}
    \input{modules/(* module.id *)/styles/(* competition.id *)/templates/intro.tex}
    \newpage
    \input{modules/(* module.id *)/styles/(* competition.id *)/templates/rules.tex}

    (@ for rid, round in semester.rounds.items() @)
        \newpage
        \pagestyle{problems}    
        \fancyhead[LE,RO]{\textit{Zadania (* round.number *). kola (* semester.genitive *) časti -- (* round.deadline.strftime('%d. %m. %Y') *)}}
        {
            \section{Zadania (* round.number *). kola}
            \centering
            \vspace{-1.3em}
            Termín odoslania (* round.deadline.strftime('%d. %m. %Y') *)\\[2pt]
        } 

        (@ for pid, problem in round.problems.items() @)%
        \setcounter{volume}{(* volume.number *)}%
        \setcounter{semester}{(* semester.number *)}%
        \setcounter{round}{(* round.number *)}%
        \setcounter{problem}{(* problem.number *)}%
        \RenewDocumentCommand{\problemDirectory}{}{\rootDirectory/(* module.id *)/(* competition.id *)/(* volume.id *)/(* semester.id *)/(* round.id *)/(* problem.id *)}%
        
        \subsection{%
            \texorpdfstring{%
                \large \textbf{(* problem.title *)}%
                (@ if problem.categories @)%
                \normalsize \hfill kategóri(@ if problem.categories|length == 1 @)a(@ else @)e(@ endif @) (* problem.categories|formatList *)%
                (@ endif @)
            }{%
                (* round.number *).(* problem.number *) (* problem.title *)%
            }%
        }%
        \protectedInput{\problemDirectory/problem.tex}%
        (@ endfor @)
    (@ endfor @)
\end{document}
